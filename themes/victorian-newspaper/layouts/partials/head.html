  <head>
    {{- $titleDefault := print .Title " | " .Site.Title -}}
    {{- if .IsHome -}}
      {{- $titleDefault = .Site.Title -}}
    {{- end -}}

    <!-- For more info about Hugo asset pipeline see:
      https://gohugo.io/hugo-pipes/introduction/
      https://gohugo.io/hugo-pipes/bundling/
    -->
    {{- $cssPreface := resources.Get "style/front.css" -}}
    {{- $cssBase := resources.Get "style/base.css" -}}
    {{- $layoutGrid := resources.Get "style/layout-grid.css" -}}
    {{- $layout := $layoutGrid -}}
    {{- $isGrid := false -}}
    {{- if $isGrid -}}
    {{- $layout = $layoutGrid -}}
    {{- end -}}
    {{- $cssOverrides := resources.Get "style/overrides.css" -}}
    {{- $cssDropCaps := resources.Get "style/drop-caps/drop-caps.css" -}}
    {{- $cssDropCapsFontDefault := "" -}}
    {{- $dropCapsFont := "goudy" -}}
    {{- if .Params.dropCapsFont -}}
      {{- $dropCapsFont = .Params.dropCapsFont -}}
    {{- else if .Site.Params.dropCapsFont -}}
      {{- $dropCapsFont = .Site.Params.dropCapsFont -}}
    {{- end -}}
    {{- $cssDropCapsFontDefault = resources.Get (printf "style/drop-caps/drop-caps_%s.css" $dropCapsFont) -}}
    {{- $cssPrint := resources.Get "style/print.css" -}}
    {{- $cssFonts := resources.Get "style/fonts.css" -}}
    {{- $cssFontSystemStack := resources.Get "style/font-system-stack.css" -}}
    {{- $cssFontDefault := resources.Get (printf "style/font-drop-caps-%s.css" $dropCapsFont) -}}
    {{- $cssSyntaxHighlights := resources.Get "style/syntax-highlighting/monokai.css" -}}
    {{- $cssVictorianTheme := resources.Get "style/victorian-theme.css" -}}
    <!--{{/* $cssEntities := resources.Get "style/entities.css" */}}-->
    <!-- CSS Load Order (proper cascade):
      1. front.css - Preface/reset
      2. base.css - Foundation with CSS variables
      3. layout-grid.css - Layout structure
      4. fonts.css - Typography base
      5. font-system-stack.css - Font fallbacks
      6. victorian-theme.css - Theme overrides + Victorian components (no !important needed)
      7. drop-caps CSS - Decorative initial capitals
      8. font-drop-caps-*.css - Drop cap fonts
      9. syntax-highlighting/*.css - Code highlighting
      10. overrides.css - User customizations
      11. print.css - Print styles (always last)
    -->
    {{- $styles := slice $cssPreface $cssBase $layout $cssFonts $cssFontSystemStack $cssVictorianTheme $cssDropCaps $cssDropCapsFontDefault $cssFontDefault $cssSyntaxHighlights $cssOverrides $cssPrint | resources.Concat "style/style.css" -}}
    <!-- minify and fingerprint only if not running locally -->
    {{- if not (in (print .Site.BaseURL) "localhost") -}}
    {{- $styles = $styles | minify | fingerprint -}}
    {{- end -}}
    <!-- map . (the current context) to "context" and $titleDefault to
      titleSite. This means that anything in the block that needs to access
      dot-variables will have to use ".context.Var" instead of ".Var". For
      example, in this file I can use ".Site.BaseURL", but in any blocks or
      partials where I pass "$context" instead of ".", those blocks or partials
      will have to use ".context.Site.BaseURL".
    -->
    {{- $context := (dict "context" . "titleSite" $titleDefault "styles" $styles) -}}
    {{- partial "head__meta.html" $context -}}
    {{- partial "head__styles.html" $context -}}
    {{- partial "head__title.html" $context -}}
    {{- partial "head__scripts.html" $context -}}
  </head>
